Фича A*
В рамках фичи: в бэкофисе реализована возможность изменения СР (Complimentary points) для игрока администратором с соответствующими пермишенами.



#1 Проверка наличия пермишена на изменение CP игрокам в БД и БО

Description
1. Описание A* - MVP
2. Таблица БД: permissions
3. Администратор с ролью superadmin авторизован в БО

Precondition
No precondition

Scenario
1. Проверить пермишен в таблице permissions
Expected result
- В таблице есть пермишен на изменение CP игрокам permissions.name = 'cp_correction'
2. Админу перейти в БО Profile - Roles
Expected result
- В перечне пермишенов роли superadmin есть пермишен на изменение CP игрокам Title cp correction
3. Открыть редактирование перечня пермишенов для любой роли
Expected result
- В перечне пермишенов есть пермишен на изменение CP игрокам Title cp correction



#2 Проверка невозможности редактирования CP игрока администратором без пермишена

Description
1. Описание A* - MVP
2. Таблицы БД: bavix_wallets с выборкой по игроку
3. CP в БО.pngimage/png

Precondition
1. Администратор авторизован в Бэкофисе Администратором с ролью != superadmin

Scenario
1. Перейти на сингл-страницу юзера /{id}
2. В разделе Status кликнуть на значение CP игрока
Expected result
- Открывается форма изменения CP
3. Изменить значение CP
Expected result
- Отображается ошибка недоступности коррекции CP
- Значение CP НЕ изменилось
- Значение EP НЕ изменилось
- Значения валютных кошельков НЕ изменились




#3 Проверка возможности редактирования CP игрока администратором с пермишеном

Description
1. Описание A* - MVP
2. БД: bavix_wallets с выборкой по игроку
3. CP в БО.pngimage/png

Precondition
1. Роли superadmin назначен пермишен редактирования CP.
2. Администратор admin с ролью superadmin авторизован в Бэкофисе

Scenario
1. Админу перейти на сингл-страницу юзера /{id}
Expected result
- В разделе Status CP выделяется цветом гиперссылки
2. В разделе Status кликнуть на значение CP игрока
Expected result
- Открывается форма изменения CP 
3. Изменить значение CP
Expected result
- Измененное значение отображается в поле CP
4. Кликнуть на кнопку Change CP
Expected result
- Отправляется успешный запрос POST /{id}
Пример тела запроса
{amount: "3"}
Ответ
{"data":{"success":true}}
- Модальное окно закрывается
- Измененное значение CP отображается в bavix_wallets.balance
- Измененное значение CP отображается на странице юзера
- Значение EP НЕ изменилось
- Значения валютных кошельков НЕ изменились



#4 Проверка endpoint на увеличение CP в БО

Description
1. Описание A* - MVP
2. БД: bavix_wallets с выборкой по юзеру
3. CP в БО.pngimage/png

Precondition
1. Администратор admin с ролью superadmin авторизован в Бэкофисе

Scenario
1. Перейти на сингл-страницу юзера /{id}
2. В разделе Status изменить значение CP игрока на большее валидное значение
Expected result
- Отправляется успешный запрос POST /{id}
- В теле запроса передается введенное значение CP
Пример тела запроса
{amount: "3"}
Ответ
{"data":{"success":true}}
- Измененное значение CP отображается в bavix_wallets.balance
- В bavix_wallets.balance отображается введенное значение CP
- Значение EP НЕ изменилось
- Значения валютных кошельков НЕ изменились



#5 Проверка endpoint на уменьшение CP в БО

Description
1. Описание A* - MVP
2. БД: bavix_wallets с выборкой по юзеру
3. CP в БО.pngimage/png

Precondition
1. Администратор admin с ролью superadmin авторизован в Бэкофисе

Scenario
1. Перейти на сингл-страницу юзера /{id}
2. В разделе Status изменить значение CP игрока на меньшее валидное значение
Expected result
- Отправляется успешный запрос POST /{id}
- В теле запроса передается введенное значение CP
Пример тела запроса
{amount: "3"}
Ответ
{"data":{"success":true}}
- В bavix_wallets.balance отображается введенное значение CP
- Значение EP НЕ изменилось
- Значения валютных кошельков НЕ изменились



#6 Проверка endpoint на валидность значения CP в БО

Description
1. Описание A* - MVP
2. БД: bavix_wallets
3. CP в БО.pngimage/png

Precondition
1. Администратор admin с ролью superadmin авторизован в Бэкофисе

Scenario
1. Перейти на сингл-страницу юзера /{id}
2. В разделе Status изменить значение CP игрока на отрицательное
Expected result
- Корректно обрабатывается ошибка ввода отрицательного значения CP
- Значение CP НЕ изменилось
- Значение EP НЕ изменилось
- Значения валютных кошельков НЕ изменились
3. Изменить значение CP игрока на 0
Expected result
- Отправляется успешный запрос POST /{id}
- В теле запроса передается введенное значение CP
Пример тела запроса
{amount: "0"}
Ответ
{"data":{"success":true}}
- В bavix_wallets.balance отображается введенное значение CP
- Значение EP НЕ изменилось
- Значения валютных кошельков НЕ изменились
4. В разделе Status изменить значение CP игрока на значение, на порядок большее соответствующего максимальному уровню ВИПки. Т.е. CP >= statuses.min_cp*10.
Expected result
- Отправляется успешный запрос POST /{id}
- В теле запроса передается введенное значение CP
Пример тела запроса
{amount: "1000000000"}
Ответ
{"data":{"success":true}}
В bavix_wallets.balance отображается введенное значение CP
- Значение EP НЕ изменилось
- Значения валютных кошельков НЕ изменились
5. В разделе Status изменить значение CP игрока на дробное значение
Expected result
- Отправляется успешный запрос POST /{id}
- В теле запроса передается введенное значение CP
Пример тела запроса
{amount: "12,3456789"}
Ответ
{"data":{"success":true}}
- В bavix_wallets.balance отображается введенное значение CP (с точностью до 5 знаков)
- Значение EP НЕ изменилось
- Значения валютных кошельков НЕ изменились



#7 Проверка доступности функциональности при увеличении CP в рамках текущего ВИП-уровня игрока

Description
1. Описание A* - MVP
2. БД: bavix_wallets, statuses

Precondition
1. Зафиксированы текущие значения кошельков и ВИП-уровня игрока
2. У игрока через БО увеличено значение CP в рамках текущего ВИП-уровня
3. Игрок авторизован

Scenario
1. Сравнить текущие значения кошельков и ВИП-уровня игрока с зафиксированными в Предусловии
Expected result
- Значение кошелька CP изменилось на заданное
- ВИП-уровень игрока не изменился
- Значения валютных кошельков не изменились
- Значение кошелька EP не изменилось
2. Проверить доступность/недоступность возможностей данного ВИП-уровня (могут меняться, необходимо уточнить доступные фичи и смотреть описание уровня в statuses)
Expected result
- Лимит на вывод соответствует ВИП-уровню
- Коэффициенты бустера Рейкбека соответствует ВИП-уровню
- Возможность забрать Рейбек соответствует ВИП-уровню
- Курс обмена EP соответствует ВИП-уровню
- и др.



#8 Проверка доступности функциональности при уменьшении CP в рамках текущего ВИП-уровня игрока

Description
1. Описание A* - MVP
2. БД: bavix_wallets, statuses

Precondition
1. Зафиксированы текущие значения кошельков и ВИП-уровня игрока
2. У игрока через БО увеличено значение CP в рамках текущего ВИП-уровня
3. Игрок авторизован

Scenario
1. Сравнить текущие значения кошельков и ВИП-уровня игрока с зафиксированными в Предусловии
Expected result
- Значение кошелька CP изменилось на заданное
- ВИП-уровень игрока не изменился
- Значения валютных кошельков не изменились
- Значение кошелька EP не изменилось
2. Проверить доступность/недоступность возможностей данного ВИП-уровня (могут меняться, необходимо уточнить доступные фичи и смотреть описание уровня в statuses)
Expected result
- Лимит на вывод соответствует ВИП-уровню
- Коэффициенты бустера Рейкбека соответствует ВИП-уровню
- Возможность забрать Рейбек соответствует ВИП-уровню
- Курс обмена EP соответствует ВИП-уровню
- и др.



#9 Проверка доступности функциональности при увеличении CP с увеличением текущего ВИП-уровня игрока

Description
1. Описание A* - MVP
2. БД: bavix_wallets, statuses

Precondition
1. Зафиксированы текущие значения кошельков и ВИП-уровня игрока
2. У игрока через БО увеличено значение CP в рамках текущего ВИП-уровня
3. Игрок авторизован

Scenario
1. Сравнить текущие значения кошельков и ВИП-уровня игрока с зафиксированными в Предусловии
Expected result
- Значение кошелька CP изменилось на заданное
- ВИП-уровень игрока изменился в соответствии с statuses
- Значения валютных кошельков не изменились
- Значение кошелька EP не изменилось
2. Проверить доступность/недоступность возможностей данного ВИП-уровня (могут меняться, необходимо уточнить доступные фичи и смотреть описание уровня в statuses)
Expected result
- Лимит на вывод соответствует ВИП-уровню
- Коэффициенты бустера Рейкбека соответствует ВИП-уровню
- Возможность забрать Рейбек соответствует ВИП-уровню
- Курс обмена EP соответствует ВИП-уровню
- и др.



#10 Проверка доступности функциональности при уменьшении CP с уменьшением текущего ВИП-уровня игрока

Description
1. Описание A* - MVP
2. БД: bavix_wallets, statuses

Precondition
1. Зафиксированы текущие значения кошельков и ВИП-уровня игрока
2. У игрока через БО увеличено значение CP в рамках текущего ВИП-уровня
3. Игрок авторизован

Scenario
1. Сравнить текущие значения кошельков и ВИП-уровня игрока с зафиксированными в Предусловии
Expected result
- Значение кошелька CP изменилось на заданное
- ВИП-уровень игрока изменился в соответствии с statuses
- Значения валютных кошельков не изменились
- Значение кошелька EP не изменилось
2. Проверить доступность/недоступность возможностей данного ВИП-уровня (могут меняться, необходимо уточнить доступные фичи и смотреть описание уровня в statuses)
Expected result
- Лимит на вывод соответствует ВИП-уровню
- Коэффициенты бустера Рейкбека соответствует ВИП-уровню
- Возможность забрать Рейбек соответствует ВИП-уровню
- Курс обмена EP соответствует ВИП-уровню
- и др.

