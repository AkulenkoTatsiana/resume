Фича Б*
В рамках фичи создана страница К*, на которую в iframe выводится функционал провайдера по осуществлению ставок.



#1 Отсутствие элементов фичи при выключенном фича-флаге

Description
1. ТЗ
2. Макеты
3. БД: configs

Precondition
configs.FFF_SPORT_BOOK = 0

Scenario
1. Проверить отсутствие элементов на главной странице:
Expected result
- В хедере кнопка Sports/Спорт
- В левом сайдбаре Sports/Спорт
- Баннер под слайдером
- Ссылка на страницу правил в футере в Info
2. Проверить отсутствие элементов на неглавной странице:
Expected result
- В хедере кнопка Sports/Спорт
- В левом сайдбаре Sports/Спорт
- Ссылка на страницу правил в футере в Info
3. Перейти по прямой ссылке /sports
Expected result
- Редирект на главную страницу



#2 Проверка элементов фичи на страницах К*

Description
1. ТЗ
2. Макеты
3. БД: configs
4. Анимация кнопки.GIFimage/gif
5. Анимация баннера.GIFimage/gif 

Precondition
configs.FFF_SPORT_BOOK = 1

Scenario
1. Перейти на главную страницу К*
2. Проверить в хедере кнопку Sports/Спорт
Expected result
- Кнопка Sports/Спорт отображается
- Есть анимация кнопки при наведении
- Клик по кнопке переводит на страницу /sports
3. Проверить в левом сайдбаре пункт Sports new/Спорт new
Expected result
- Пункт Sports new/Спорт new отображается
- Клик по пункту переводит на страницу /sports
4. Проверить баннер под слайдером
Expected result
- Баннер отображается
- Есть анимация картинки при наведении
- Клик по баннеру переводит на страницу /sports
5. Проверить ссылку на страницу правил в футере в Info
Expected result
- Ссылка отображается
- Клик по ссылке переводит на страницу правил /sports_terms_and_conditions
6. Прокликать пункты меню левого сайдбара
Expected result
- На каждой странице присутствуют элементы фичи (кнопка, баннер, пункт меню)
7. Перейти на неглавную страницу К*. Повторить шаги 2, 3, 5



#3 Проверка интерфейса страницы Sports

Description
1. ТЗ
2. Макеты
3. БД: configs

Precondition
configs.FFF_SPORT_BOOK = 1

Scenario
1. Перейти на страницу Sports/Спорт
Expected result
- Интерфейс страницы соответствует макету
- iframe Sportbook на всю страницу (остается только хедер)
- Кнопка в хедере Sports/Спорт меняется на Go to C*/Перейти в К*
2. Настроить в БО турнир
Expected result
- Верхний счетчик от Быстрых Турниров отображается над iframe
3. Настроить в БО M* (см. # К*)
Expected result
- Попап M* не отображается на странице
- Тост M* отображается на странице
- Парашюты M* не отображаются над iframe
4. Покликать на кнопку сворачивания/разворачивания левого сайдбара
Expected result
- Сайдбар сворачивается/разворачивается
5. Прокликать пункты левого сайдбара
Expected result
- Осуществляются переходы на соответствующие страницы
6. Кликнуть на кнопку Go to C*/Перейти в К*
Expected result
- Открывается главная страница К*



#4 Проверка недоступности ставок у незалогиненного игрока

Description
1. ТЗ
2. Макеты
3. БД: configs

Precondition
1. configs.FFF_SPORT_BOOK = 1
2. Игрок не залогинен в К*

Scenario
1. Перейти на страницу Sports/Спорт
Expected result
- Интерфейс страницы соответствует макету
2. Предпринять попытку сделать ставку
Expected result
- Система уведомляет о недоступности данного действия



#5 Б* игрока

Description
1. ТЗ
2. Макеты
3. БД: configs, game_histories, bavix_wallets, rakeback. Таблицы открыты с выборкой по игроку
4. Настроен M* (см. # К*)

Precondition
1. configs.FFF_SPORT_BOOK = 1
2. Игрок залогинен в К*
3. У игрока нет активных бонусов
4. Игрок находится на странице Sports/Спорт

Scenario
1. Сделать ставку
Expected result
- Провайдер принимает ставку
- Добавляется запись в Историю игр
- Изменяется баланс кошелька на сумму и валюту ставки
- Отсутствует начисление CP и EP
- Отсутствует начисление Релоада
- Отсутствует начисление Рейкбека
- Отсутствует начисление Кэшбека
- M* отрабатывает как на обычной игре

2. Проверить по окончании игры
Expected result
- Редактируется запись в Историю игр при наличии выигрыша по ставке
- Изменяется баланс кошелька при наличии выигрыша по ставке



#6818 Проверка попапа о наличии активных бонусов

Description
1. ТЗ
2. Макеты
3. БД: configs
4. Попап активных бонусов.PNGimage/png

Precondition
1. configs.FFF_SPORT_BOOK = 1
2. Игрок залогинен в К*
3. У игрока есть бонус в статусе active

Scenario
1. Перейти на страницу Sports/Спорт
Expected result
- Происходит переход на страницу /sport
- Появляется попап о наличии активных бонусов
2. Кликнуть "Открыть спорт"
Expected result
- Попап закрывается
- Игрок остается на странице Спорт
- Игроку недоступно совершение ставок (см. #6)
3. Обновить страницу Sports/Спорт
Expected result
- Появляется попап о наличии активных бонусов
4. Кликнуть "Мои бонусы"
Expected result
- Попап закрывается
- Игрок остается на странице Спорт
- Открывается модальное окно ЛК на вкладке Бонусы - Активные
5. Закрыть модальное окно ЛК
Expected result
- Модальное окно закрывается
- Игрок остается на странице Спорт
- Игроку недоступно совершение ставок (см. #6)
6. Обновить страницу Sports/Спорт
Expected result
- Появляется попап о наличии активных бонусов
7. Кликнуть "Мои бонусы"
Expected result
- Попап закрывается
- Игрок остается на странице Спорт
- Открывается модальное окно ЛК на вкладке Бонусы - Активные
8. Отменить все активные бонусы
9. Закрыть модальное окно ЛК
Expected result
- Модальное окно закрывается
- Игрок остается на странице Спорт
- Игроку доступно совершение ставок (см. #5)



#6 Проверка недоступности ставок при наличии активных бонусов

Description
1. ТЗ
2. Макеты
3. БД: configs

Precondition
1. configs.FFF_SPORT_BOOK = 1
2. Игрок залогинен в К*
3. У игрока есть активный бонус
4. Игрок находится на странице Sports/Спорт
4. Попап о наличии активных бонусов закрыт

Scenario
1. Предпринять попытку сделать ставку
Expected result
- Провайдер уведомляет о недоступности данного действия



#7 Проверка смены кошелька во время б*

Description
1. ТЗ
2. Макеты
3. БД: configs, game_histories, bavix_wallets

Precondition
1. configs.FFF_SPORT_BOOK = 1
2. Игрок залогинен в К*
3. У игрока нет активных бонусов

Scenario
1. Перейти на страницу Sports/Спорт
Expected result
- Кошелек в хедере соответствует кошельку, выбранному до перехода на страницу Спорт
- Валюта в iframe Sport соответствует кошельку из хедера
2. Сделать ставку
Expected result
- Провайдер принимает ставку
- Изменяется баланс кошелька из хедера
- У добавленной записи game_histories.currency_code соответствует кошельку из хедера
3. Сменить кошелек в хедере на странице Sports/Спорт
Expected result
- Кошелек в хедере соответствует кошельку, выбранному до перехода на страницу Спорт
- Валюта в iframe Sport соответствует кошельку из хедера
4. Сделать ставку
Expected result
- Провайдер принимает ставку
- Изменяется баланс кошелька из хедера
- У добавленной записи game_histories.currency_code соответствует кошельку из хедера
5. Шаги 3-4 повторить для всех доступных кошельков игрока
6. Вернуться в К*
Expected result
Кошелек в хедере соответствует кошельку, выбранному на странице Спорт
